/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(['./DvtToolkit'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.

  // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  
D.eS=function(a,b,c){this.Init(a,b,c)};(0,D.ca)("DvtTagCloud",D.eS);D.w.l(D.eS,D.lj,"DvtTagCloud");D.eS.newInstance=function(a,b,c){return new D.eS(a,b,c)};D.eS.prototype.Init=function(a,b,c){D.eS.o.Init.call(this,a,b,c);this.j().Jc.ta().setAttributeNS(null,"text-rendering","geometricPrecision");this.Ia=new D.fS(this,a,this.Od,this);this.Ia.le(this);(0,D.Ef)()||(0,D.rj)(this.Ia,new D.gS(this.Ia));this.pf=new D.hS;this.Za=[];this.Aq=[];this.Tg=null;this.Gd=new D.du(this.j());(0,D.Dq)(this.Ia,this.Gd)};
D.eS.prototype.P=function(a,b,c){!(0,window.isNaN)(b)&&!(0,window.isNaN)(c)&&(this.Ga=b,this.Ua=c);this.YN();this.ud(a);this.Sa&&this.Sa.stop();this.Mg=this.X;this.hQ=this.Za;this.Za=[];this.ula=[];this.X=new D.B(this.j());this.k(this.X);D.iS.P(this,this.X,new D.y(0,0,this.Ga,this.Ua));this.Um&&(0,D.Al)(this.Um,this.D.selection,this.Sq());b=this.D.animationDuration;c=new D.y(0,0,this.Ga,this.Ua);this.Mg?"none"!==this.D.animationOnDataChange&&a&&(this.lf=new D.B(this.j()),this.k(this.lf),a=new D.Hm(this.j(),
this.lf),(0,D.Im)(a,this.hQ,this.Za),this.Sa=a.Mq()):"none"!==this.D.animationOnDisplay&&(this.Sa=D.Xk.$x(this.j(),D.Xk.sw,this.X,c,b));this.Sa?(this.Ia.Ac(),this.Ia.ei(this),this.Sa.he(this.Wfa,this),this.Sa.play()):this.Wfa();this.Pn()};D.eS.prototype.render=D.eS.prototype.P;D.eS.prototype.Pca=(0,D.q)("Za");D.eS.prototype.Df=function(){this.Ik||(this.Ik=new D.jS(this));return this.Ik};D.eS.prototype.getAutomation=D.eS.prototype.Df;D.eS.prototype.VD=function(a,b){this.Aq.push(a);this.ula[b]=a};
D.eS.prototype.Sq=(0,D.s)("Aq");D.eS.prototype.yh=(0,D.s)("ula");D.eS.prototype.Ee=function(a){this.D.highlightedCategories=D.il.Y(a);(0,D.jl)(a,this.Sq(),"any"===this.D.highlightMatch);this.Tg&&this.Tg.Ee(a)};D.eS.prototype.highlight=D.eS.prototype.Ee;D.eS.prototype.select=function(a){this.D.selection=D.il.Y(a);this.Um&&(0,D.Al)(this.Um,this.D.selection,this.Sq())};D.eS.prototype.select=D.eS.prototype.select;D.u=D.eS.prototype;
D.u.ud=function(a){a?this.D=this.pf.Tj(a):this.D||(this.D=(0,D.tj)(this));a=this.D.selectionMode;this.Um="single"===a?new D.Tk("s"):"multiple"===a?new D.Tk("m"):null;this.Ia.wu(this.Um);(0,D.Sk)()||(this.D.animationOnDisplay="none",this.D.animationOnDataChange="none")};D.u.Fj=function(){return(0,D.gk)(this.q(),"componentName","DvtUtilBundle","TAG_CLOUD")};
D.u.Wfa=function(){this.Mg&&(this.removeChild(this.Mg),this.Mg.Q(),this.Mg=null);this.lf&&(this.removeChild(this.lf),this.lf.Q(),this.lf=null);this.Sa&&(this.Sa=null,this.Ia.le(this));this.D.highlightedCategories&&0<this.D.highlightedCategories.length&&this.Ee(this.D.highlightedCategories)};D.u.YN=function(){this.Ia.Ac();this.Aq.length=0};D.u.la=(0,D.s)("Ia");
D.u.Od=function(a,b){var c=a.Ta();if(c==D.pl.Hw||c==D.pl.Ny){var d=a.Nk,e=D.H.wa(this.D.hiddenCategories,d);c==D.pl.Hw&&0>e&&this.D.hiddenCategories.push(d);c==D.pl.Ny&&0<=e&&this.D.hiddenCategories.splice(e,1);this.P(this.D,this.Ga,this.Ua)}else if("categoryRollOver"==c||"categoryRollOut"==c)this!=b?this.Ee(a.categories):this.Tg&&this.Tg!=b&&this.Tg.Od(a,b);a&&this.dispatchEvent(a)};D.u.Wt=function(){for(var a=[],b=this.Um.getSelection(),c=0;c<b.length;c++)a=a.concat(b[c].Yc());return a};
D.eS.prototype.xj=function(a,b,c){return this.Gd.xj(c)};D.eS.prototype.isDragAvailable=D.eS.prototype.xj;D.eS.prototype.wk=function(a,b){return this.Gd.wk(a,b)};D.eS.prototype.getDragTransferable=D.eS.prototype.wk;D.eS.prototype.Xt=function(a,b){return this.Gd.Xt(a,b)};D.eS.prototype.getDragOverFeedback=D.eS.prototype.Xt;D.eS.prototype.vp=function(a,b){return this.Gd.vp(a,b)};D.eS.prototype.getDragContext=D.eS.prototype.vp;D.eS.prototype.Mv=function(a,b){return this.Gd.Mv(a,b)};
D.eS.prototype.getDragOffset=D.eS.prototype.Mv;D.eS.prototype.Tv=function(a,b){return this.Gd.Tv(a,b)};D.eS.prototype.getPointerOffset=D.eS.prototype.Tv;D.eS.prototype.Xv=function(){this.Gd.Xv()};D.eS.prototype.initiateDrag=D.eS.prototype.Xv;D.eS.prototype.bs=function(){this.Gd.bs()};D.eS.prototype.dragDropEnd=D.eS.prototype.bs;
D.eS.prototype.oo=function(a,b,c){this.ul||(this.ul=new D.mS);return this.ul.oo(a,b,c)};D.eS.prototype.acceptDrag=D.eS.prototype.oo;
D.jS=(0,D.q)("Ox");(0,D.ca)("DvtTagCloudAutomation",D.jS);D.w.l(D.jS,D.xj,"DvtTagCloudAutomation");D.jS.prototype.ol=function(a){return(a=(0,D.yj)(this.Ox.Ia,a))&&a instanceof D.kS?"item["+this.Ox.yh().indexOf(a)+"]":null};D.jS.prototype.Ff=function(a){if("tooltip"==a)return(0,D.Rl)(this.Ox);var b=a.indexOf("[");return 0<b&&"item"===a.substring(0,b)&&(a=(0,window.parseInt)(a.substring(b+1,a.length-1)),a=this.Ox.yh()[a])?a.Yc()[0].ta():null};D.jS.prototype.getDomElementForSubId=D.jS.prototype.Ff;
D.jS.prototype.getItem=function(a){if(a=this.Ox.yh()[a]){var b={};b.color=a.si();b.tooltip=a.zc();b.label=a.Mc();b.value=a.getValue();b.selected=a.Ca();return b}return null};D.jS.prototype.getItem=D.jS.prototype.getItem;D.jS.prototype.UL=function(){return this.Ox.Sq().length};D.jS.prototype.getItemCount=D.jS.prototype.UL;
D.oS=function(a,b,c,d,e,f,g){this.Init(a,b,c,d,e,f,g)};D.w.l(D.oS,D.Sj,"DvtTagCloudItem");D.u=D.oS.prototype;D.u.Init=function(a,b,c,d,e,f,g){D.oS.o.Init.call(this,b,c,d,e,f,g);this.Ox=a;this.uZ();f&&(0,D.pS)(this,f)};D.u.jb=function(a){this.Rh!=a&&((this.Rh=a)?this.yl?this.Ha(this.UW):this.Ha(this.DY):this.Ha(this.ZF))};D.u.Ob=function(){this.yl||(this.yl=!0,this.Rh?this.Ha(this.UW):this.Ha(this.U6))};D.u.Db=function(){this.Rh?this.Ha(this.DY):this.Ha(this.ZF);this.yl=!1};
D.u.ff=function(a,b){var c=new D.en(this.j(),this,D.qS.xa(this.Ox)),d=this.fc(),e=b.fc(),f=!1,g=e.A("color"),h=d.A("color");if(g!=h){var i=this;this.Ha(d.W("color",g));(0,D.T)(c.J,"typeColor",this,function(){return i.fc().A("color")},function(a){i.Ha(i.fc().W("color",a))},h)}e=(0,window.parseFloat)(e.A("font-size"));d=(0,window.parseFloat)(d.A("font-size"));e!=d&&(f=!0,i=this,this.Ge(e),(0,D.T)(c.J,"typeNumber",this,function(){return(0,window.parseFloat)(i.fc().A("font-size"))},this.Ge,d));g=b.ja();
d=this.ja();e=b.vn();h=this.vn();if(d!=g||f&&h!=e)h!=e&&(f=g,g=b.Wd.F(void 0),g="left"==e?f+g.e:"right"==e?f-g.e:f),this.ca(g),(0,D.T)(c.J,"typeNumber",this,this.ja,this.ca,d);f=b.na();d=this.na();d!=f&&(this.va(f),(0,D.T)(c.J,"typeNumber",this,this.na,this.va,d));b.B(0);a.add(c,1)};D.u.hh=function(a){a.add(new D.gn(this.j(),this,D.qS.xa(this.Ox)),0)};D.u.pg=function(a){this.B(0);a.add(new D.Km(this.j(),this,D.qS.xa(this.Ox)),2)};D.u.Ge=function(a){D.oS.o.Ge.call(this,a);(0,D.pS)(this,this.fc())};
D.pS=function(a,b){a.ZF=b.Y();var c=a.ZF.A("color");a.ZF.W("background-color",null);a.U6=a.ZF.Y();var d=(0,D.rS)(c,0.3);a.U6.W("background-color",d);a.U6.W("color",D.M.rj(d));a.DY=a.ZF.Y();a.DY.W("background-color",c);a.DY.W("color",D.M.rj(c));a.UW=a.ZF.Y();c=(0,D.rS)(c,0.6);a.UW.W("background-color",c);a.UW.W("color",D.M.rj(c))};
D.rS=function(a,b){var c=D.M.qe(a),d=D.M.oe(a),e=D.M.ne(a);return D.M.WA(window.Math.floor(255*(1-b)+b*c),window.Math.floor(255*(1-b)+b*d),window.Math.floor(255*(1-b)+b*e))};
D.kS=function(a,b,c){this.Init(a,b,c)};D.w.l(D.kS,D.w,"DvtTagCloudObjPeer");D.u=D.kS.prototype;D.u.Init=function(a,b,c){this.H=a;this.ug=b;this.oa=c;this.UE=this.Rh=!1;c.url?(b.Td("link"),this.P7=D.A.uD("_blank",c.url)):b.Td("img");this.Gq()};D.u.getId=function(){return this.oa.id};D.u.Mc=function(){return this.oa.label};D.u.getValue=function(){return this.oa.value};D.u.zc=function(){return this.oa.shortDesc};D.u.Ae=function(){return this.oa.action};
D.u.Be=function(){var a=this.H.q().tooltip;return a?(0,D.Qo)(this.H.j().fe(),a,this.tp()):this.zc()};D.u.tp=function(){return{id:this.getId(),label:this.Mc(),color:this.si(),value:this.getValue()}};D.u.uD=(0,D.s)("P7");D.u.si=function(){this.Zn||(this.Zn=(new D.F(this.oa.style)).A("color"));return this.Zn};D.u.Jf=(0,D.q)("UE");D.u.Aa=(0,D.s)("UE");D.u.Ca=(0,D.s)("Rh");D.u.jb=function(a){this.Rh=a;this.ug.jb(a);this.Gq()};D.u.Ob=function(){this.ug.Ob()};D.u.Db=function(){this.ug.Db()};
D.u.zd=function(a){var b=this.H.Ia.Rf;a.type==D.dk||b.Zq(a)?b=this:b.sg(a)?(b=this.H.Sq(),a=39==a.keyCode||40==a.keyCode?!0:!1,a=D.H.wa(b,this)+(a?1:-1),b=a<b.length&&0<=a?b[a]:null):b=null;return b};D.u.Ce=function(a){return this.ug.F(a)};D.u.wj=function(){return this.ug.ta()};D.u.Ud=function(){this.Ib=!0;this.Ob()};D.u.ic=function(){this.Ib&&(this.Ib=!1,this.Db())};D.u.oc=(0,D.s)("Ib");D.u.Yc=function(){return[this.ug]};
D.u.ec=function(){var a=[];this.Aa()&&a.push((0,D.P)("DvtUtilBundle",this.Ca()?"STATE_SELECTED":"STATE_UNSELECTED"));return(0,D.hk)(this.zc(),a)};D.u.Lc=function(){return this.oa.categories};D.u.Gq=function(){(0,D.Ye)()||this.ug.Zb("label",this.ec())};D.u.pd=function(){if(!this.md&&(this.md=[],this.oa.showPopupBehaviors))for(var a=this.oa.showPopupBehaviors,b=0;b<a.length;b++)this.md.push(new D.Ai(a[b].popupId,a[b].triggerType,a[b].alignId,a[b].align));return this.md};
D.u.xj=function(a){return this.H.Um?a[0]:null};D.u.wk=function(){var a=this.H;this.Ca()||(a.Um.Km(this,!1),a.Ia.Lv());for(var b=[],a=a.Um.getSelection(),c=0;c<a.length;c++){var d=a[c];d instanceof D.kS&&b.push(d.getId())}return b};D.u.Wt=function(){return this.H.Wt()};
D.hS=function(){this.Init({alta:D.lS})};D.w.l(D.hS,D.Hj,"DvtTagCloudDefaults");
D.lS={animationOnDisplay:"none",animationOnDataChange:"none",emptyText:null,hiddenCategories:[],hideAndShowBehavior:"none",highlightedCategories:[],highlightMatch:"all",hoverBehavior:"none",layout:"rectangular",selectionMode:"none",_statusMessageStyle:new D.F('font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #333333;'),styleDefaults:{animationDuration:500,hoverBehaviorDelay:200,style:new D.F('font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #333333;')},touchResponse:"auto"};
D.iS={};D.w.l(D.iS,D.w,"DvtTagCloudRenderer");D.iS.P=function(a,b,c){D.iS.Et(a,b,c);D.iS.XC(a,b,c);D.iS.Pw(c);var d=a.q();d.items&&0<d.items.length?(d=D.iS.i9(a,b,c),0<d.length?(a.Pca(d),(0,D.vj)(a.Ia,a.Sq()[0])):D.iS.KQ(a,b,c)):D.iS.KQ(a,b,c)};D.iS.KQ=function(a,b,c){var d=a.q(),e=d.emptyText;e||(e=(0,D.gk)(d,"labelNoData","DvtUtilBundle","NO_DATA",null));D.Ve.Lm(b,e,new D.y(c.x,c.y,c.e,c.g),a.Ia,d._statusMessageStyle)};D.iS.Et=function(a,b,c){a=new D.C(a.j(),c.x,c.y,c.e,c.g);(0,D.qi)(a);b.k(a)};
D.iS.i9=function(a,b,c){for(var d=a.q(),e=[],f=d.items,g=window.Number.MAX_VALUE,h=-window.Number.MAX_VALUE,i=0;i<f.length;i++)g=window.Math.min(g,f[i].value),h=window.Math.max(h,f[i].value);g=D.sS.ZIa(g,h);h=D.H.VG(d.hiddenCategories);for(i=0;i<f.length;i++){var k=f[i];k.categories||(k.categories=[k.label]);if(!h||!D.H.qM(h,k.categories)){var l=d.styleDefaults.style.Y();(0,D.Qf)(l,k.style);l.W("font-size",g.call(null,k.value).toString());var l=new D.oS(a,a.j(),k.label,0,0,l,k.id),m=new D.kS(a,l,
k);a.Ia.Fa(l,m);a.VD(m,i);"none"!==d.selectionMode&&m.Jf(!0);(m.Aa()||k.url||m.Ae())&&l.setCursor("pointer");e.push(l);b.k(l)}}0<e.length&&("cloud"===d.layout?D.sS.cHa(c,e):D.sS.YMa(c,e,(0,D.D)(a.j())));return e};
D.iS.XC=function(a,b,c){var d=a.q(),e=d.legend;if(e&&e.sections){e=D.il.Y(e);e.orientation="horizontal";e.halign="center";e.hoverBehavior=d.hoverBehavior;e.hideAndShowBehavior=d.hideAndShowBehavior;e.hiddenCategories=d.hiddenCategories;d=(0,D.rn)(a.j(),a.Od,a);b.k(d);var f=d.Bp(e,c.e,c.g/3);d.P(e,f.e,f.g);(0,D.pn)(c,"bottom",d,f.e,f.g,0);a.Tg&&(a.Tg.Q(),b.removeChild(a.Tg));a.Tg=d}};D.iS.Pw=function(a){a.x=window.Math.round(a.x);a.y=window.Math.round(a.y);a.e=window.Math.round(a.e);a.g=window.Math.round(a.g)};
D.sS=(0,D.j)();D.w.l(D.sS,D.w,"DvtTagCloudLayoutUtils");D.sS.ZIa=function(a,b){return function(c){return 12+window.Math.ceil(12*(2*(c-a)/(b-a)))}};
D.sS.cHa=function(a,b){var c=[],d=10/180,e=10/180;a.e>a.g?d*=a.e/a.g:e*=a.g/a.e;for(var f=2*window.Math.PI/180,g=null,h=0,i=[],k=[],l=0;l<b.length;l++)for(var m=!1,n=0,o=4,p=b[l],r=p.F(),h=window.Math.max(h,(0,window.parseFloat)(p.fc().A("font-size"))),t=-1;!m;){var v=n%180;void 0===i[v]&&(i[v]=window.Math.cos(n*f));void 0===k[v]&&(k[v]=window.Math.sin(n*f));var z=d*n*i[v],L=e*n*k[v],J=new D.y(z,L,r.e,r.g),m=!0;-1!=t&&c[t].S_(J)&&(m=!1);if(m)for(v=0;v<l;v++)if(c[v].S_(J)){t=v;m=!1;break}m&&(g=g?(0,D.qo)(g,
J):J,t=-1,c[l]=J,p.ca(z),p.va(-r.y+L));3600===n?o=3:5400===n?o=2:10800===n&&(o=1);n+=o}c=window.Math.max(g.e/a.e,g.g/a.g);d=g.x+g.e/2;g=g.y+g.g/2;for(v=0;v<b.length;v++)p=b[v],p.ca(a.x+p.ja()/c+(a.e/2-d/c)),p.va(a.y+p.na()/c+(a.g/2-g/c)),e=(0,window.parseFloat)(p.fc().A("font-size")),p.Ge(e/c)};
D.sS.YMa=function(a,b,c){for(var d=[],e=0,f=0,g=0,h=0;h<b.length;h++){var i=b[h],k=i.F(),e=window.Math.max(e,k.e),f=window.Math.max(f,k.g),g=window.Math.max(g,(0,window.parseFloat)(i.fc().A("font-size")));d.push(new D.wg(k.e,k.g))}h=0;for(i=(a.e-10)/e;0.001<i-h;)e=(h+i)/2,g=D.sS.Aia(d,(a.e-10)/e),g.length*(e*f+2)-2>a.g-10?i=e:h=e;e=h;g=D.sS.Aia(d,(a.e-10)/e);g.push(b.length);for(h=0;h<g.length-1;h++){var k=g[h],l=g[h+1],m=0,n=0,o=!0;if(1<l-k){for(var i=0,p=k;p<l;p++)i+=d[p].e*e,n=window.Math.max(n,
d[p].g*e);m=(a.e-10-i)/(l-k-1);h==g.length-2&&(p=0.5*n,p<m&&i+(l-k)*p<0.9*(a.e-10)&&(m=p,o=!1))}for(var n=5+(h+1)*(f*e+2)-2,r=c?a.e-5:5,p=k;p<l;p++){var i=b[p],t=(0,window.parseFloat)(i.fc().A("font-size"));i.Ge(t*e);i.va(a.y+n);o&&p==l-1&&p!=k?c?(i.vh(),i.ca(a.x+5)):(i.wh(),i.ca(a.x+a.e-5)):(i.ca(a.x+r),c?(i.wh(),r-=d[p].e*e+m):(i.vh(),r+=d[p].e*e+m))}}};D.sS.Aia=function(a,b){var c=[0],d=a[0].e+2;if(1<a.length)for(var e=1;e<a.length;e++)d+a[e].e>b&&(c.push(e),d=0),d+=a[e].e+2;return c};
D.qS={};D.w.l(D.qS,D.w,"DvtTagCloudStyleUtils");D.qS.xa=function(a){return a.q().styleDefaults.animationDuration/1E3};
D.fS=function(a,b,c,d){this.Init(b,c,d);this.H=a};D.w.l(D.fS,D.Jj,"DvtTagCloudEventManager");D.fS.prototype.BI=function(a){a=(0,D.yj)(this,a.target);(0,D.nS)(a);this.sG(a)};D.fS.prototype.yN=function(a){a=(0,D.yj)(this,a.target);this.sG(a)};D.fS.prototype.or=function(a){a=(0,D.yj)(this,a.target);(0,D.nS)(a);this.sG(a)};D.nS=function(a){a instanceof D.kS&&(a=a.uD())&&a.call()};D.fS.prototype.Ih=function(a){var b=!0,c=this.dd();13==a.keyCode?(0,D.nS)(c):b=D.fS.o.Ih.call(this,a);return b};
D.fS.prototype.dm=function(a,b,c){a=this.H.q();"dim"==a.hoverBehavior&&(b=b.Lc?b.Lc():[],a.highlightedCategories=c?b.slice():null,c=new D.om(c?"categoryRollOver":"categoryRollOut",a.highlightedCategories),b=(0,D.Po)(a.styleDefaults.hoverBehaviorDelay),this.DB.Od(c,this.H.Sq(),b,"any"==a.highlightMatch))};D.fS.prototype.sG=function(a){a&&(a.Ae&&a.Ae())&&this.Fh(new D.Lj("action",a.Ae(),a.getId()))};D.fS.prototype.zu=function(){return this.H.q().touchResponse};
D.gS=function(a){this.Init(a)};D.w.l(D.gS,D.ck,"DvtTagCloudKeyboardHandler");D.gS.prototype.Init=function(a){D.gS.o.Init.call(this,a)};D.gS.prototype.oy=function(a){return this.sg(a)&&!a.ctrlKey};D.gS.prototype.Zq=function(a){return 32==a.keyCode&&a.ctrlKey};
D.mS=(0,D.j)();D.w.l(D.mS,D.fu,"DvtTagCloudDropTarget");D.mS.prototype.oo=function(a,b,c){return c[0]};

  return D;
});